<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create worker configuration — rrq_worker_config • rrq</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create worker configuration — rrq_worker_config"><meta name="description" content="Create a worker configuration, suitable to pass into
rrq_worker_config_save. The results of this function
should not be modified."><meta property="og:description" content="Create a worker configuration, suitable to pass into
rrq_worker_config_save. The results of this function
should not be modified."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rrq</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.23</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/rrq.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/fault-tolerance.html">Fault tolerance</a></li>
    <li><a class="dropdown-item" href="../articles/messages.html">messages</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mrc-ide/rrq/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create worker configuration</h1>
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/rrq/blob/master/R/worker_config.R" class="external-link"><code>R/worker_config.R</code></a></small>
      <div class="d-none name"><code>rrq_worker_config.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a worker configuration, suitable to pass into
<a href="rrq_worker_config_save.html">rrq_worker_config_save</a>. The results of this function
should not be modified.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rrq_worker_config</span><span class="op">(</span></span>
<span>  queue <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  logdir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  poll_queue <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  timeout_idle <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  poll_process <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  timeout_process_die <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  heartbeat_period <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  offload_threshold_size <span class="op">=</span> <span class="cn">Inf</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-queue">queue<a class="anchor" aria-label="anchor" href="#arg-queue"></a></dt>
<dd><p>Optional character vector of queues to listen on for
tasks. There is a default queue which is always listened on
(called 'default'). You can specify additional names here and
tasks put onto these queues with <code><a href="rrq_task_create_expr.html">rrq_task_create_expr()</a></code> (or
other functions) will have <em>higher</em> priority than the
default. You can explicitly list the "default" queue (e.g.,
<code>queue = c("high", "default", "low")</code>) to set the position of
the default queue.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical, indicating if the worker should print
logging output to the screen.  Logging to screen has a small but
measurable performance cost, and if you will not collect system
logs from the worker then it is wasted time.  Logging to the
redis server is always enabled.</p></dd>


<dt id="arg-logdir">logdir<a class="anchor" aria-label="anchor" href="#arg-logdir"></a></dt>
<dd><p>Optional log directory to use for writing logs when
queuing tasks in a separate process.  If given, then logs will
be saved to <code>&lt;logdir&gt;/&lt;task_id&gt;</code>.  This directory should be
writable by all workers and readable by the controller.</p></dd>


<dt id="arg-poll-queue">poll_queue<a class="anchor" aria-label="anchor" href="#arg-poll-queue"></a></dt>
<dd><p>Polling time for new tasks on the queue or
messages. Longer values here will reduce the impact on the
database but make workers less responsive to being killed with
an interrupt (control-C or Escape).  The default should be good
for most uses, but shorter values are used for
debugging. Importantly, longer times here do not increase the
time taken for a worker to detect new tasks.</p></dd>


<dt id="arg-timeout-idle">timeout_idle<a class="anchor" aria-label="anchor" href="#arg-timeout-idle"></a></dt>
<dd><p>Optional timeout that sets the length of time
after which the worker will exit if it has not processed a task.
This is (roughly) equivalent to issuing a <code>TIMEOUT_SET</code>
message after initialising the worker, except that it's
guaranteed to be run by all workers.</p></dd>


<dt id="arg-poll-process">poll_process<a class="anchor" aria-label="anchor" href="#arg-poll-process"></a></dt>
<dd><p>Polling time indicating how long to wait for a
background process to produce stdout or stderr. Only used for
tasks queued with <code>separate_process</code> <code>TRUE</code>.</p></dd>


<dt id="arg-timeout-process-die">timeout_process_die<a class="anchor" aria-label="anchor" href="#arg-timeout-process-die"></a></dt>
<dd><p>Timeout indicating how long to wait
wait for the background process to respond to SIGTERM, either as
we stop a worker or cancel a task. Only used for tasks queued
with <code>separate_process</code> <code>TRUE</code>. If your tasks may take several
seconds to stop, you may want to increase this to ensure a clean
exit.</p></dd>


<dt id="arg-heartbeat-period">heartbeat_period<a class="anchor" aria-label="anchor" href="#arg-heartbeat-period"></a></dt>
<dd><p>Optional period for the heartbeat.  If
non-NULL then a heartbeat process will be started (using
<code><a href="heartbeat.html">rrq_heartbeat</a></code>) which can be used to build fault
tolerant queues. See <code><a href="../articles/fault-tolerance.html">vignette("fault-tolerance")</a></code> for
details. If <code>NULL</code> (the default), then no heartbeat is
configured.</p></dd>


<dt id="arg-offload-threshold-size">offload_threshold_size<a class="anchor" aria-label="anchor" href="#arg-offload-threshold-size"></a></dt>
<dd><p>The object size beyond which task results are
offloaded to disk instead of being stored in Redis. See
<code><a href="rrq_controller.html">rrq_controller</a></code> for details. If <code>Inf</code> (the default), results are
never offloaded.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of values with class <code>rrq_worker_config</code>; these
should be considered read-only, and contain only the validated
input parameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">rrq</span><span class="fu">::</span><span class="fu">rrq_worker_config</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $queue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "default"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $verbose</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $logdir</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $poll_queue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $timeout_idle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $poll_process</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $timeout_process_die</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $heartbeat_period</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $offload_threshold_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "rrq_worker_config"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rich FitzJohn, Robert Ashton.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

